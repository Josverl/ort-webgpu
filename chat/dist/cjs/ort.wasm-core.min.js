/*!
 * ONNX Runtime Web v1.18.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
"use strict";var Ke=Object.defineProperty;var Kr=Object.getOwnPropertyDescriptor;var Zr=Object.getOwnPropertyNames;var Qr=Object.prototype.hasOwnProperty;var B=(r,t)=>()=>(r&&(t=r(r=0)),t);var en=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Se=(r,t)=>{for(var e in t)Ke(r,e,{get:t[e],enumerable:!0})},tn=(r,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Zr(t))!Qr.call(r,o)&&o!==e&&Ke(r,o,{get:()=>t[o],enumerable:!(a=Kr(t,o))||a.enumerable});return r};var Ue=r=>tn(Ke({},"__esModule",{value:!0}),r);var Le,le,we,rn,Fe,ke=B(()=>{"use strict";Le=new Map,le=[],we=(r,t,e)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){let a=Le.get(r);if(a===void 0)Le.set(r,{backend:t,priority:e});else{if(a.priority>e)return;if(a.priority===e&&a.backend!==t)throw new Error(`cannot register backend "${r}" using priority ${e}`)}if(e>=0){let o=le.indexOf(r);o!==-1&&le.splice(o,1);for(let d=0;d<le.length;d++)if(Le.get(le[d]).priority<=e){le.splice(d,0,r);return}le.push(r)}return}throw new TypeError("not a valid backend")},rn=async r=>{let t=Le.get(r);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let e=!!t.initPromise;try{return e||(t.initPromise=t.backend.init(r)),await t.initPromise,t.initialized=!0,t.backend}catch(a){return e||(t.error=`${a}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},Fe=async r=>{let t=r.executionProviders||[],e=t.map(f=>typeof f=="string"?f:f.name),a=e.length===0?le:e,o,d=[],i=new Set;for(let f of a){let l=await rn(f);typeof l=="string"?d.push({name:f,err:l}):(o||(o=l),o===l&&i.add(f))}if(!o)throw new Error(`no available backend found. ERR: ${d.map(f=>`[${f.name}] ${f.err}`).join(", ")}`);for(let{name:f,err:l}of d)e.includes(f)&&console.warn(`removing requested execution provider "${f}" from session options because it is not available: ${l}`);let c=t.filter(f=>i.has(typeof f=="string"?f:f.name));return[o,new Proxy(r,{get:(f,l)=>l==="executionProviders"?c:Reflect.get(f,l)})]}});var Ct=B(()=>{"use strict";ke()});var _t,Dt=B(()=>{"use strict";_t="1.18.0"});var Rt,V,Ze=B(()=>{"use strict";Dt();Rt="warning",V={wasm:{},webgl:{},webgpu:{},versions:{common:_t},set logLevel(r){if(r!==void 0){if(typeof r!="string"||["verbose","info","warning","error","fatal"].indexOf(r)===-1)throw new Error(`Unsupported logging level: ${r}`);Rt=r}},get logLevel(){return Rt}};Object.defineProperty(V,"logLevel",{enumerable:!0})});var U,Ut=B(()=>{"use strict";Ze();U=V});var Lt,Ft,kt=B(()=>{"use strict";Lt=(r,t)=>{let e=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);e.width=r.dims[3],e.height=r.dims[2];let a=e.getContext("2d");if(a!=null){let o,d;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(o=r.dims[2],d=r.dims[3]):(o=r.dims[3],d=r.dims[2]);let i=t?.format!==void 0?t.format:"RGB",c=t?.norm,f,l;c===void 0||c.mean===void 0?f=[255,255,255,255]:typeof c.mean=="number"?f=[c.mean,c.mean,c.mean,c.mean]:(f=[c.mean[0],c.mean[1],c.mean[2],0],c.mean[3]!==void 0&&(f[3]=c.mean[3])),c===void 0||c.bias===void 0?l=[0,0,0,0]:typeof c.bias=="number"?l=[c.bias,c.bias,c.bias,c.bias]:(l=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(l[3]=c.bias[3]));let y=d*o,w=0,h=y,b=y*2,E=-1;i==="RGBA"?(w=0,h=y,b=y*2,E=y*3):i==="RGB"?(w=0,h=y,b=y*2):i==="RBG"&&(w=0,b=y,h=y*2);for(let A=0;A<d;A++)for(let S=0;S<o;S++){let _=(r.data[w++]-l[0])*f[0],x=(r.data[h++]-l[1])*f[1],C=(r.data[b++]-l[2])*f[2],N=E===-1?255:(r.data[E++]-l[3])*f[3];a.fillStyle="rgba("+_+","+x+","+C+","+N+")",a.fillRect(S,A,1,1)}if("toDataURL"in e)return e.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Ft=(r,t)=>{let e=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),a;if(e!=null){let o,d,i;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(o=r.dims[2],d=r.dims[1],i=r.dims[3]):(o=r.dims[3],d=r.dims[2],i=r.dims[1]);let c=t!==void 0&&t.format!==void 0?t.format:"RGB",f=t?.norm,l,y;f===void 0||f.mean===void 0?l=[255,255,255,255]:typeof f.mean=="number"?l=[f.mean,f.mean,f.mean,f.mean]:(l=[f.mean[0],f.mean[1],f.mean[2],255],f.mean[3]!==void 0&&(l[3]=f.mean[3])),f===void 0||f.bias===void 0?y=[0,0,0,0]:typeof f.bias=="number"?y=[f.bias,f.bias,f.bias,f.bias]:(y=[f.bias[0],f.bias[1],f.bias[2],0],f.bias[3]!==void 0&&(y[3]=f.bias[3]));let w=d*o;if(t!==void 0&&(t.format!==void 0&&i===4&&t.format!=="RGBA"||i===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,b=0,E=1,A=2,S=3,_=0,x=w,C=w*2,N=-1;c==="RGBA"?(_=0,x=w,C=w*2,N=w*3):c==="RGB"?(_=0,x=w,C=w*2):c==="RBG"&&(_=0,C=w,x=w*2),a=e.createImageData(o,d);for(let O=0;O<d*o;b+=h,E+=h,A+=h,S+=h,O++)a.data[b]=(r.data[_++]-y[0])*l[0],a.data[E]=(r.data[x++]-y[1])*l[1],a.data[A]=(r.data[C++]-y[2])*l[2],a.data[S]=N===-1?255:(r.data[N++]-y[3])*l[3]}else throw new Error("Can not access image data");return a}});var Qe,Mt,Nt,Wt,Gt,Ht=B(()=>{"use strict";Me();Qe=(r,t)=>{if(r===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:e,width:a}=t,o=t.norm??{mean:255,bias:0},d,i;typeof o.mean=="number"?d=[o.mean,o.mean,o.mean,o.mean]:d=[o.mean[0],o.mean[1],o.mean[2],o.mean[3]??255],typeof o.bias=="number"?i=[o.bias,o.bias,o.bias,o.bias]:i=[o.bias[0],o.bias[1],o.bias[2],o.bias[3]??0];let c=t.format!==void 0?t.format:"RGBA",f=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",l=e*a,y=f==="RGBA"?new Float32Array(l*4):new Float32Array(l*3),w=4,h=0,b=1,E=2,A=3,S=0,_=l,x=l*2,C=-1;c==="RGB"&&(w=3,h=0,b=1,E=2,A=-1),f==="RGBA"?C=l*3:f==="RBG"?(S=0,x=l,_=l*2):f==="BGR"&&(x=0,_=l,S=l*2);for(let O=0;O<l;O++,h+=w,E+=w,b+=w,A+=w)y[S++]=(r[h]+i[0])/d[0],y[_++]=(r[b]+i[1])/d[1],y[x++]=(r[E]+i[2])/d[2],C!==-1&&A!==-1&&(y[C++]=(r[A]+i[3])/d[3]);return f==="RGBA"?new j("float32",y,[1,4,e,a]):new j("float32",y,[1,3,e,a])},Mt=async(r,t)=>{let e=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,a=typeof ImageData<"u"&&r instanceof ImageData,o=typeof ImageBitmap<"u"&&r instanceof ImageBitmap,d=typeof r=="string",i,c=t??{},f=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=y=>y instanceof HTMLCanvasElement||y instanceof OffscreenCanvas?y.getContext("2d"):null;if(e){let y=f();y.width=r.width,y.height=r.height;let w=l(y);if(w!=null){let h=r.height,b=r.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(h=t.resizedHeight,b=t.resizedWidth),t!==void 0){if(c=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");c.tensorFormat="RGBA",c.height=h,c.width=b}else c.tensorFormat="RGBA",c.height=h,c.width=b;w.drawImage(r,0,0),i=w.getImageData(0,0,b,h).data}else throw new Error("Can not access image data")}else if(a){let y,w;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(y=t.resizedHeight,w=t.resizedWidth):(y=r.height,w=r.width),t!==void 0&&(c=t),c.format="RGBA",c.height=y,c.width=w,t!==void 0){let h=f();h.width=w,h.height=y;let b=l(h);if(b!=null)b.putImageData(r,0,0),i=b.getImageData(0,0,w,y).data;else throw new Error("Can not access image data")}else i=r.data}else if(o){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");let y=f();y.width=r.width,y.height=r.height;let w=l(y);if(w!=null){let h=r.height,b=r.width;return w.drawImage(r,0,0,b,h),i=w.getImageData(0,0,b,h).data,c.height=h,c.width=b,Qe(i,c)}else throw new Error("Can not access image data")}else{if(d)return new Promise((y,w)=>{let h=f(),b=l(h);if(!r||!b)return w();let E=new Image;E.crossOrigin="Anonymous",E.src=r,E.onload=()=>{h.width=E.width,h.height=E.height,b.drawImage(E,0,0,h.width,h.height);let A=b.getImageData(0,0,h.width,h.height);c.height=h.height,c.width=h.width,y(Qe(A.data,c))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(i!==void 0)return Qe(i,c);throw new Error("Input data provided is not supported - aborted tensor creation")},Nt=(r,t)=>{let{width:e,height:a,download:o,dispose:d}=t,i=[1,a,e,4];return new j({location:"texture",type:"float32",texture:r,dims:i,download:o,dispose:d})},Wt=(r,t)=>{let{dataType:e,dims:a,download:o,dispose:d}=t;return new j({location:"gpu-buffer",type:e??"float32",gpuBuffer:r,dims:a,download:o,dispose:d})},Gt=(r,t,e)=>new j({location:"cpu-pinned",type:r,data:t,dims:e??[t.length]})});var de,xe,$t,zt,jt=B(()=>{"use strict";de=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),xe=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),$t=!1,zt=()=>{if(!$t){$t=!0;let r=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,e=typeof Float16Array<"u"&&Float16Array.from;r&&(de.set("int64",BigInt64Array),xe.set(BigInt64Array,"int64")),t&&(de.set("uint64",BigUint64Array),xe.set(BigUint64Array,"uint64")),e?(de.set("float16",Float16Array),xe.set(Float16Array,"float16")):de.set("float16",Uint16Array)}}});var Yt,qt,Vt=B(()=>{"use strict";Me();Yt=r=>{let t=1;for(let e=0;e<r.length;e++){let a=r[e];if(typeof a!="number"||!Number.isSafeInteger(a))throw new TypeError(`dims[${e}] must be an integer, got: ${a}`);if(a<0)throw new RangeError(`dims[${e}] must be a non-negative integer, got: ${a}`);t*=a}return t},qt=(r,t)=>{switch(r.location){case"cpu":return new j(r.type,r.data,t);case"cpu-pinned":return new j({location:"cpu-pinned",data:r.data,type:r.type,dims:t});case"texture":return new j({location:"texture",texture:r.texture,type:r.type,dims:t});case"gpu-buffer":return new j({location:"gpu-buffer",gpuBuffer:r.gpuBuffer,type:r.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${r.location} is not supported`)}}});var j,Me=B(()=>{"use strict";kt();Ht();jt();Vt();j=class{constructor(t,e,a){zt();let o,d;if(typeof t=="object"&&"location"in t)switch(this.dataLocation=t.location,o=t.type,d=t.dims,t.location){case"cpu-pinned":{let c=de.get(o);if(!c)throw new TypeError(`unsupported type "${o}" to create tensor from pinned buffer`);if(!(t.data instanceof c))throw new TypeError(`buffer should be of type ${c.name}`);this.cpuData=t.data;break}case"texture":{if(o!=="float32")throw new TypeError(`unsupported type "${o}" to create tensor from texture`);this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break}case"gpu-buffer":{if(o!=="float32"&&o!=="float16"&&o!=="int32"&&o!=="int64"&&o!=="uint32"&&o!=="uint8"&&o!=="bool")throw new TypeError(`unsupported type "${o}" to create tensor from gpu buffer`);this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let c,f;if(typeof t=="string")if(o=t,f=a,t==="string"){if(!Array.isArray(e))throw new TypeError("A string tensor's data must be a string array.");c=e}else{let l=de.get(t);if(l===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(e)){if(t==="float16"&&l===Uint16Array)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");t==="uint64"||t==="int64"?c=l.from(e,BigInt):c=l.from(e)}else if(e instanceof l)c=e;else throw new TypeError(`A ${o} tensor's data must be type of ${l}`)}else if(f=e,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let l=typeof t[0];if(l==="string")o="string",c=t;else if(l==="boolean")o="bool",c=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${l}.`)}else{let l=xe.get(t.constructor);if(l===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);o=l,c=t}if(f===void 0)f=[c.length];else if(!Array.isArray(f))throw new TypeError("A tensor's dims must be a number array");d=f,this.cpuData=c,this.dataLocation="cpu"}let i=Yt(d);if(this.cpuData&&i!==this.cpuData.length)throw new Error(`Tensor's size(${i}) does not match data length(${this.cpuData.length}).`);this.type=o,this.dims=d,this.size=i}static async fromImage(t,e){return Mt(t,e)}static fromTexture(t,e){return Nt(t,e)}static fromGpuBuffer(t,e){return Wt(t,e)}static fromPinnedBuffer(t,e,a){return Gt(t,e,a)}toDataURL(t){return Lt(this,t)}toImageData(t){return Ft(this,t)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(t){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let e=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=e,t&&this.disposer&&(this.disposer(),this.disposer=void 0),e}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(t){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return qt(this,t)}}});var G,Ne=B(()=>{"use strict";Me();G=j});var et,Xt,oe,se,tt=B(()=>{"use strict";Ze();et=(r,t)=>{(typeof V.trace>"u"?!V.wasm.trace:!V.trace)||console.timeStamp(`${r}::ORT::${t}`)},Xt=(r,t)=>{let e=new Error().stack?.split(/\r\n|\r|\n/g)||[],a=!1;for(let o=0;o<e.length;o++){if(a&&!e[o].includes("TRACE_FUNC")){let d=`FUNC_${r}::${e[o].trim().split(" ")[1]}`;t&&(d+=`::${t}`),et("CPU",d);return}e[o].includes("TRACE_FUNC")&&(a=!0)}},oe=r=>{(typeof V.trace>"u"?!V.wasm.trace:!V.trace)||Xt("BEGIN",r)},se=r=>{(typeof V.trace>"u"?!V.wasm.trace:!V.trace)||Xt("END",r)}});var We,Jt=B(()=>{"use strict";ke();Ne();tt();We=class r{constructor(t){this.handler=t}async run(t,e,a){oe();let o={},d={};if(typeof t!="object"||t===null||t instanceof G||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let i=!0;if(typeof e=="object"){if(e===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(e instanceof G)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(e)){if(e.length===0)throw new TypeError("'fetches' cannot be an empty array.");i=!1;for(let l of e){if(typeof l!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(l)===-1)throw new RangeError(`'fetches' contains invalid output name: ${l}.`);o[l]=null}if(typeof a=="object"&&a!==null)d=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else{let l=!1,y=Object.getOwnPropertyNames(e);for(let w of this.outputNames)if(y.indexOf(w)!==-1){let h=e[w];(h===null||h instanceof G)&&(l=!0,i=!1,o[w]=h)}if(l){if(typeof a=="object"&&a!==null)d=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else d=e}}else if(typeof e<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let l of this.inputNames)if(typeof t[l]>"u")throw new Error(`input '${l}' is missing in 'feeds'.`);if(i)for(let l of this.outputNames)o[l]=null;let c=await this.handler.run(t,o,d),f={};for(let l in c)if(Object.hasOwnProperty.call(c,l)){let y=c[l];y instanceof G?f[l]=y:f[l]=new G(y.type,y.data,y.dims)}return se(),f}async release(){return this.handler.dispose()}static async create(t,e,a,o){oe();let d,i={};if(typeof t=="string"){if(d=t,typeof e=="object"&&e!==null)i=e;else if(typeof e<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(d=t,typeof e=="object"&&e!==null)i=e;else if(typeof e<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){let y=t,w=0,h=t.byteLength;if(typeof e=="object"&&e!==null)i=e;else if(typeof e=="number"){if(w=e,!Number.isSafeInteger(w))throw new RangeError("'byteOffset' must be an integer.");if(w<0||w>=y.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${y.byteLength}).`);if(h=t.byteLength-w,typeof a=="number"){if(h=a,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||w+h>y.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${y.byteLength-w}].`);if(typeof o=="object"&&o!==null)i=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else if(typeof a<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof e<"u")throw new TypeError("'options' must be an object.");d=new Uint8Array(y,w,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[c,f]=await Fe(i),l=await c.createInferenceSessionHandler(d,f);return se(),new r(l)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}});var Kt,Zt=B(()=>{"use strict";Jt();Kt=We});var Qt=B(()=>{"use strict"});var er=B(()=>{"use strict"});var tr=B(()=>{"use strict"});var rr=B(()=>{"use strict"});var nn,Ge,nr=B(()=>{"use strict";ke();Ne();nn="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Ge=class r{constructor(t,e,a){this.handler=t,this.hasOptimizerModel=e,this.hasEvalModel=a}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(t,e){let a=t.evalModel||"",o=t.optimizerModel||"",d=e||{},[i,c]=await Fe(d);if(i.createTrainingSessionHandler){let f=await i.createTrainingSessionHandler(t.checkpointState,t.trainModel,a,o,c);return new r(f,!!t.optimizerModel,!!t.evalModel)}else throw new Error(nn)}typeNarrowingForRunStep(t,e,a,o,d){let i={},c={};if(typeof a!="object"||a===null||a instanceof G||Array.isArray(a))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let f=!0;if(typeof o=="object"){if(o===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(o instanceof G)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(o)){if(o.length===0)throw new TypeError("'fetches' cannot be an empty array.");f=!1;for(let l of o){if(typeof l!="string")throw new TypeError("'fetches' must be a string array or an object.");if(e.indexOf(l)===-1)throw new RangeError(`'fetches' contains invalid output name: ${l}.`);i[l]=null}if(typeof d=="object"&&d!==null)c=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else{let l=!1,y=Object.getOwnPropertyNames(o);for(let w of e)if(y.indexOf(w)!==-1){let h=o[w];(h===null||h instanceof G)&&(l=!0,f=!1,i[w]=h)}if(l){if(typeof d=="object"&&d!==null)c=d;else if(typeof d<"u")throw new TypeError("'options' must be an object.")}else c=o}}else if(typeof o<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let l of t)if(typeof a[l]>"u")throw new Error(`input '${l}' is missing in 'feeds'.`);if(f)for(let l of e)i[l]=null;return[i,c]}convertHandlerReturnTypeToMapOfTensors(t){let e={};for(let a in t)if(Object.hasOwnProperty.call(t,a)){let o=t[a];o instanceof G?e[a]=o:e[a]=new G(o.type,o.data,o.dims)}return e}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(t,e,a){let[o,d]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,t,e,a),i=await this.handler.runTrainStep(t,o,d);return this.convertHandlerReturnTypeToMapOfTensors(i)}async runOptimizerStep(t){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(t||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(t,e,a){if(this.hasEvalModel){let[o,d]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,t,e,a),i=await this.handler.runEvalStep(t,o,d);return this.convertHandlerReturnTypeToMapOfTensors(i)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(t=!0){return this.handler.getParametersSize(t)}async loadParametersBuffer(t,e=!0){let a=await this.getParametersSize(e);if(t.length!==4*a)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(t,e)}async getContiguousParameters(t=!0){return this.handler.getContiguousParameters(t)}async release(){return this.handler.dispose()}}});var or,sr=B(()=>{"use strict";nr();or=Ge});var rt={};Se(rt,{InferenceSession:()=>Kt,TRACE:()=>et,TRACE_FUNC_BEGIN:()=>oe,TRACE_FUNC_END:()=>se,Tensor:()=>G,TrainingSession:()=>or,env:()=>U,registerBackend:()=>we});var pe=B(()=>{"use strict";Ct();Ut();Zt();Ne();Qt();er();tt();tr();rr();sr()});var ur={};Se(ur,{createReadStream:()=>ir,readFile:()=>on,readFileSync:()=>sn});var on,sn,ir,fr=B(()=>{on=void 0,sn=void 0,ir=void 0});var cr={};Se(cr,{join:()=>an});var an,lr=B(()=>{an=void 0});var mr=en((pr,nt)=>{"use strict";var dr=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(t={}){var e=t,a,o;e.ready=new Promise((n,s)=>{a=n,o=s});var d=Object.assign({},e),i="./this.program",c=typeof window=="object",f=typeof importScripts=="function",l=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",y="",w,h,b;if(l){var E=(fr(),Ue(ur)),A=(lr(),Ue(cr));y=f?A.dirname(y)+"/":__dirname+"/",w=(n,s)=>(n=n.startsWith("file://")?new URL(n):A.normalize(n),E.readFileSync(n,s?void 0:"utf8")),b=n=>(n=w(n,!0),n.buffer||(n=new Uint8Array(n)),n),h=(n,s,u,m=!0)=>{n=n.startsWith("file://")?new URL(n):A.normalize(n),E.readFile(n,m?void 0:"utf8",(g,T)=>{g?u(g):s(m?T.buffer:T)})},!e.thisProgram&&1<process.argv.length&&(i=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),e.inspect=()=>"[Emscripten Module object]"}else(c||f)&&(f?y=self.location.href:typeof document<"u"&&document.currentScript&&(y=document.currentScript.src),r&&(y=r),y.indexOf("blob:")!==0?y=y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):y="",w=n=>{var s=new XMLHttpRequest;return s.open("GET",n,!1),s.send(null),s.responseText},f&&(b=n=>{var s=new XMLHttpRequest;return s.open("GET",n,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),h=(n,s,u)=>{var m=new XMLHttpRequest;m.open("GET",n,!0),m.responseType="arraybuffer",m.onload=()=>{m.status==200||m.status==0&&m.response?s(m.response):u()},m.onerror=u,m.send(null)});var S=e.print||console.log.bind(console),_=e.printErr||console.error.bind(console);Object.assign(e,d),d=null,e.thisProgram&&(i=e.thisProgram);var x;e.wasmBinary&&(x=e.wasmBinary);var C=e.noExitRuntime||!0;typeof WebAssembly!="object"&&Z("no native wasm support detected");var N,O,Ee=!1,ae,K,v,R;function Be(){var n=N.buffer;e.HEAP8=ae=new Int8Array(n),e.HEAP16=new Int16Array(n),e.HEAP32=v=new Int32Array(n),e.HEAPU8=K=new Uint8Array(n),e.HEAPU16=new Uint16Array(n),e.HEAPU32=R=new Uint32Array(n),e.HEAPF32=new Float32Array(n),e.HEAPF64=new Float64Array(n)}var Ce=[],_e=[],ve=[];function ie(){var n=e.preRun.shift();Ce.unshift(n)}var I=0,Q=null,re=null;function Z(n){throw e.onAbort&&e.onAbort(n),n="Aborted("+n+")",_(n),Ee=!0,n=new WebAssembly.RuntimeError(n+". Build with -sASSERTIONS for more info."),o(n),n}function ue(n){return n.startsWith("data:application/octet-stream;base64,")}var W;if(W="ort-wasm.wasm",!ue(W)){var X=W;W=e.locateFile?e.locateFile(X,y):y+X}function qe(n){if(n==W&&x)return new Uint8Array(x);if(b)return b(n);throw"both async and sync fetching of the wasm failed"}function me(n){if(!x&&(c||f)){if(typeof fetch=="function"&&!n.startsWith("file://"))return fetch(n,{credentials:"same-origin"}).then(s=>{if(!s.ok)throw"failed to load wasm binary file at '"+n+"'";return s.arrayBuffer()}).catch(()=>qe(n));if(h)return new Promise((s,u)=>{h(n,m=>s(new Uint8Array(m)),u)})}return Promise.resolve().then(()=>qe(n))}function Te(n,s,u){return me(n).then(m=>WebAssembly.instantiate(m,s)).then(m=>m).then(u,m=>{_("failed to asynchronously prepare wasm: "+m),Z(m)})}function De(n,s){var u=W;return x||typeof WebAssembly.instantiateStreaming!="function"||ue(u)||u.startsWith("file://")||l||typeof fetch!="function"?Te(u,n,s):fetch(u,{credentials:"same-origin"}).then(m=>WebAssembly.instantiateStreaming(m,n).then(s,function(g){return _("wasm streaming compile failed: "+g),_("falling back to ArrayBuffer instantiation"),Te(u,n,s)}))}var ne,ee=n=>{for(;0<n.length;)n.shift()(e)};function fe(n){this.va=n-24,this.Ea=function(s){R[this.va+4>>2>>>0]=s},this.za=function(s){R[this.va+8>>2>>>0]=s},this.xa=function(s,u){this.ya(),this.Ea(s),this.za(u)},this.ya=function(){R[this.va+16>>2>>>0]=0}}var Oe=0,$=0,H=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,te=(n,s,u)=>{s>>>=0;var m=s+u;for(u=s;n[u]&&!(u>=m);)++u;if(16<u-s&&n.buffer&&H)return H.decode(n.subarray(s,u));for(m="";s<u;){var g=n[s++];if(g&128){var T=n[s++]&63;if((g&224)==192)m+=String.fromCharCode((g&31)<<6|T);else{var P=n[s++]&63;g=(g&240)==224?(g&15)<<12|T<<6|P:(g&7)<<18|T<<12|P<<6|n[s++]&63,65536>g?m+=String.fromCharCode(g):(g-=65536,m+=String.fromCharCode(55296|g>>10,56320|g&1023))}}else m+=String.fromCharCode(g)}return m},he=(n,s)=>(n>>>=0)?te(K,n,s):"",Ae=n=>{for(var s=0,u=0;u<n.length;++u){var m=n.charCodeAt(u);127>=m?s++:2047>=m?s+=2:55296<=m&&57343>=m?(s+=4,++u):s+=3}return s},Ve=(n,s,u,m)=>{if(u>>>=0,!(0<m))return 0;var g=u;m=u+m-1;for(var T=0;T<n.length;++T){var P=n.charCodeAt(T);if(55296<=P&&57343>=P){var z=n.charCodeAt(++T);P=65536+((P&1023)<<10)|z&1023}if(127>=P){if(u>=m)break;s[u++>>>0]=P}else{if(2047>=P){if(u+1>=m)break;s[u++>>>0]=192|P>>6}else{if(65535>=P){if(u+2>=m)break;s[u++>>>0]=224|P>>12}else{if(u+3>=m)break;s[u++>>>0]=240|P>>18,s[u++>>>0]=128|P>>12&63}s[u++>>>0]=128|P>>6&63}s[u++>>>0]=128|P&63}}return s[u>>>0]=0,u-g},ye=n=>n%4===0&&(n%100!==0||n%400===0),mt=[0,31,60,91,121,152,182,213,244,274,305,335],ht=[0,31,59,90,120,151,181,212,243,273,304,334],yt=n=>{var s=Ae(n)+1,u=vt(s);return u&&Ve(n,K,u,s),u},Xe={},wt=()=>{if(!Je){var n={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:i||"./this.program"},s;for(s in Xe)Xe[s]===void 0?delete n[s]:n[s]=Xe[s];var u=[];for(s in n)u.push(`${s}=${n[s]}`);Je=u}return Je},Je,qr=[null,[],[]],gt=[31,29,31,30,31,30,31,31,30,31,30,31],bt=[31,28,31,30,31,30,31,31,30,31,30,31];function Vr(n){var s=Array(Ae(n)+1);return Ve(n,s,0,s.length),s}function Et(n,s,u,m){function g(p,D,k){for(p=typeof p=="number"?p.toString():p||"";p.length<D;)p=k[0]+p;return p}function T(p,D){return g(p,D,"0")}function P(p,D){function k(Bt){return 0>Bt?-1:0<Bt?1:0}var ce;return(ce=k(p.getFullYear()-D.getFullYear()))===0&&(ce=k(p.getMonth()-D.getMonth()))===0&&(ce=k(p.getDate()-D.getDate())),ce}function z(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function J(p){var D=p.ra;for(p=new Date(new Date(p.sa+1900,0,1).getTime());0<D;){var k=p.getMonth(),ce=(ye(p.getFullYear())?gt:bt)[k];if(D>ce-p.getDate())D-=ce-p.getDate()+1,p.setDate(1),11>k?p.setMonth(k+1):(p.setMonth(0),p.setFullYear(p.getFullYear()+1));else{p.setDate(p.getDate()+D);break}}return k=new Date(p.getFullYear()+1,0,4),D=z(new Date(p.getFullYear(),0,4)),k=z(k),0>=P(D,p)?0>=P(k,p)?p.getFullYear()+1:p.getFullYear():p.getFullYear()-1}n>>>=0,s>>>=0,u>>>=0,m>>>=0;var Y=v[m+40>>2>>>0];m={Ca:v[m>>2>>>0],Ba:v[m+4>>2>>>0],ta:v[m+8>>2>>>0],wa:v[m+12>>2>>>0],ua:v[m+16>>2>>>0],sa:v[m+20>>2>>>0],ma:v[m+24>>2>>>0],ra:v[m+28>>2>>>0],Fa:v[m+32>>2>>>0],Aa:v[m+36>>2>>>0],Da:Y?he(Y):""},u=he(u),Y={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var q in Y)u=u.replace(new RegExp(q,"g"),Y[q]);var It="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Pt="January February March April May June July August September October November December".split(" ");Y={"%a":p=>It[p.ma].substring(0,3),"%A":p=>It[p.ma],"%b":p=>Pt[p.ua].substring(0,3),"%B":p=>Pt[p.ua],"%C":p=>T((p.sa+1900)/100|0,2),"%d":p=>T(p.wa,2),"%e":p=>g(p.wa,2," "),"%g":p=>J(p).toString().substring(2),"%G":p=>J(p),"%H":p=>T(p.ta,2),"%I":p=>(p=p.ta,p==0?p=12:12<p&&(p-=12),T(p,2)),"%j":p=>{for(var D=0,k=0;k<=p.ua-1;D+=(ye(p.sa+1900)?gt:bt)[k++]);return T(p.wa+D,3)},"%m":p=>T(p.ua+1,2),"%M":p=>T(p.Ba,2),"%n":()=>`
`,"%p":p=>0<=p.ta&&12>p.ta?"AM":"PM","%S":p=>T(p.Ca,2),"%t":()=>"	","%u":p=>p.ma||7,"%U":p=>T(Math.floor((p.ra+7-p.ma)/7),2),"%V":p=>{var D=Math.floor((p.ra+7-(p.ma+6)%7)/7);if(2>=(p.ma+371-p.ra-2)%7&&D++,D)D==53&&(k=(p.ma+371-p.ra)%7,k==4||k==3&&ye(p.sa)||(D=1));else{D=52;var k=(p.ma+7-p.ra-1)%7;(k==4||k==5&&ye(p.sa%400-1))&&D++}return T(D,2)},"%w":p=>p.ma,"%W":p=>T(Math.floor((p.ra+7-(p.ma+6)%7)/7),2),"%y":p=>(p.sa+1900).toString().substring(2),"%Y":p=>p.sa+1900,"%z":p=>{p=p.Aa;var D=0<=p;return p=Math.abs(p)/60,(D?"+":"-")+("0000"+(p/60*100+p%60)).slice(-4)},"%Z":p=>p.Da,"%%":()=>"%"},u=u.replace(/%%/g,"\0\0");for(q in Y)u.includes(q)&&(u=u.replace(new RegExp(q,"g"),Y[q](m)));return u=u.replace(/\0\0/g,"%"),q=Vr(u),q.length>s?0:(ae.set(q,n>>>0),q.length-1)}var Xr={a:function(n,s,u){throw n>>>=0,new fe(n).xa(s>>>0,u>>>0),Oe=n,$++,Oe},e:function(){return 0},H:function(){},x:function(){},z:function(){},k:function(){return 0},F:function(){},B:function(){},E:function(){},g:function(){},y:function(){},v:function(){},G:function(){},w:function(){},l:()=>!0,o:function(n,s,u){n=s+2097152>>>0<4194305-!!n?(n>>>0)+4294967296*s:NaN,u>>>=0,n=new Date(1e3*n),v[u>>2>>>0]=n.getUTCSeconds(),v[u+4>>2>>>0]=n.getUTCMinutes(),v[u+8>>2>>>0]=n.getUTCHours(),v[u+12>>2>>>0]=n.getUTCDate(),v[u+16>>2>>>0]=n.getUTCMonth(),v[u+20>>2>>>0]=n.getUTCFullYear()-1900,v[u+24>>2>>>0]=n.getUTCDay(),v[u+28>>2>>>0]=(n.getTime()-Date.UTC(n.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},p:function(n,s,u){n=s+2097152>>>0<4194305-!!n?(n>>>0)+4294967296*s:NaN,u>>>=0,n=new Date(1e3*n),v[u>>2>>>0]=n.getSeconds(),v[u+4>>2>>>0]=n.getMinutes(),v[u+8>>2>>>0]=n.getHours(),v[u+12>>2>>>0]=n.getDate(),v[u+16>>2>>>0]=n.getMonth(),v[u+20>>2>>>0]=n.getFullYear()-1900,v[u+24>>2>>>0]=n.getDay(),v[u+28>>2>>>0]=(ye(n.getFullYear())?mt:ht)[n.getMonth()]+n.getDate()-1|0,v[u+36>>2>>>0]=-(60*n.getTimezoneOffset()),s=new Date(n.getFullYear(),6,1).getTimezoneOffset();var m=new Date(n.getFullYear(),0,1).getTimezoneOffset();v[u+32>>2>>>0]=(s!=m&&n.getTimezoneOffset()==Math.min(m,s))|0},q:function(n){n>>>=0;var s=new Date(v[n+20>>2>>>0]+1900,v[n+16>>2>>>0],v[n+12>>2>>>0],v[n+8>>2>>>0],v[n+4>>2>>>0],v[n>>2>>>0],0),u=v[n+32>>2>>>0],m=s.getTimezoneOffset(),g=new Date(s.getFullYear(),6,1).getTimezoneOffset(),T=new Date(s.getFullYear(),0,1).getTimezoneOffset(),P=Math.min(T,g);return 0>u?v[n+32>>2>>>0]=+(g!=T&&P==m):0<u!=(P==m)&&(g=Math.max(T,g),s.setTime(s.getTime()+6e4*((0<u?P:g)-m))),v[n+24>>2>>>0]=s.getDay(),v[n+28>>2>>>0]=(ye(s.getFullYear())?mt:ht)[s.getMonth()]+s.getDate()-1|0,v[n>>2>>>0]=s.getSeconds(),v[n+4>>2>>>0]=s.getMinutes(),v[n+8>>2>>>0]=s.getHours(),v[n+12>>2>>>0]=s.getDate(),v[n+16>>2>>>0]=s.getMonth(),v[n+20>>2>>>0]=s.getYear(),n=s.getTime()/1e3,Tt((ne=n,1<=+Math.abs(ne)?0<ne?+Math.floor(ne/4294967296)>>>0:~~+Math.ceil((ne-+(~~ne>>>0))/4294967296)>>>0:0)),n>>>0},m:function(){return-52},n:function(){},t:function(n,s,u){function m(J){return(J=J.toTimeString().match(/\(([A-Za-z ]+)\)$/))?J[1]:"GMT"}u>>>=0;var g=new Date().getFullYear(),T=new Date(g,0,1),P=new Date(g,6,1);g=T.getTimezoneOffset();var z=P.getTimezoneOffset();R[n>>>0>>2>>>0]=60*Math.max(g,z),v[s>>>0>>2>>>0]=+(g!=z),n=m(T),s=m(P),n=yt(n),s=yt(s),z<g?(R[u>>2>>>0]=n,R[u+4>>2>>>0]=s):(R[u>>2>>>0]=s,R[u+4>>2>>>0]=n)},d:()=>{Z("")},h:function(){return Date.now()},u:function(){return 4294901760},b:()=>performance.now(),I:function(n,s,u){return s>>>=0,K.copyWithin(n>>>0>>>0,s>>>0,s+(u>>>0)>>>0)},s:function(n){n>>>=0;var s=K.length;if(4294901760<n)return!1;for(var u=1;4>=u;u*=2){var m=s*(1+.2/u);m=Math.min(m,n+100663296);var g=Math;m=Math.max(n,m);e:{g=g.min.call(g,4294901760,m+(65536-m%65536)%65536)-N.buffer.byteLength+65535>>>16;try{N.grow(g),Be();var T=1;break e}catch{}T=void 0}if(T)return!0}return!1},C:function(n,s){n>>>=0,s>>>=0;var u=0;return wt().forEach(function(m,g){var T=s+u;for(g=R[n+4*g>>2>>>0]=T,T=0;T<m.length;++T)ae[g++>>0>>>0]=m.charCodeAt(T);ae[g>>0>>>0]=0,u+=m.length+1}),0},D:function(n,s){n>>>=0,s>>>=0;var u=wt();R[n>>2>>>0]=u.length;var m=0;return u.forEach(function(g){m+=g.length+1}),R[s>>2>>>0]=m,0},f:()=>52,j:function(){return 52},r:function(){return 70},i:function(n,s,u,m){s>>>=0,u>>>=0,m>>>=0;for(var g=0,T=0;T<u;T++){var P=R[s>>2>>>0],z=R[s+4>>2>>>0];s+=8;for(var J=0;J<z;J++){var Y=K[P+J>>>0],q=qr[n];Y===0||Y===10?((n===1?S:_)(te(q,0)),q.length=0):q.push(Y)}g+=z}return R[m>>2>>>0]=g,0},A:Et,c:function(n,s,u,m){return Et(n>>>0,s>>>0,u>>>0,m>>>0)}};(function(){function n(u){if(u=u.exports,O=u=Jr(u),N=O.J,Be(),_e.unshift(O.K),I--,e.monitorRunDependencies&&e.monitorRunDependencies(I),I==0&&(Q!==null&&(clearInterval(Q),Q=null),re)){var m=re;re=null,m()}return u}var s={a:Xr};if(I++,e.monitorRunDependencies&&e.monitorRunDependencies(I),e.instantiateWasm)try{return e.instantiateWasm(s,n)}catch(u){_("Module.instantiateWasm callback failed with error: "+u),o(u)}return De(s,function(u){n(u.instance)}).catch(o),{}})(),e._OrtInit=(n,s)=>(e._OrtInit=O.L)(n,s),e._OrtGetLastError=(n,s)=>(e._OrtGetLastError=O.M)(n,s),e._OrtCreateSessionOptions=(n,s,u,m,g,T,P,z,J,Y)=>(e._OrtCreateSessionOptions=O.N)(n,s,u,m,g,T,P,z,J,Y),e._OrtAppendExecutionProvider=(n,s)=>(e._OrtAppendExecutionProvider=O.O)(n,s),e._OrtAddFreeDimensionOverride=(n,s,u)=>(e._OrtAddFreeDimensionOverride=O.P)(n,s,u),e._OrtAddSessionConfigEntry=(n,s,u)=>(e._OrtAddSessionConfigEntry=O.Q)(n,s,u),e._OrtReleaseSessionOptions=n=>(e._OrtReleaseSessionOptions=O.R)(n),e._OrtCreateSession=(n,s,u)=>(e._OrtCreateSession=O.S)(n,s,u),e._OrtReleaseSession=n=>(e._OrtReleaseSession=O.T)(n),e._OrtGetInputOutputCount=(n,s,u)=>(e._OrtGetInputOutputCount=O.U)(n,s,u),e._OrtGetInputName=(n,s)=>(e._OrtGetInputName=O.V)(n,s),e._OrtGetOutputName=(n,s)=>(e._OrtGetOutputName=O.W)(n,s),e._OrtFree=n=>(e._OrtFree=O.X)(n),e._OrtCreateTensor=(n,s,u,m,g,T)=>(e._OrtCreateTensor=O.Y)(n,s,u,m,g,T),e._OrtGetTensorData=(n,s,u,m,g)=>(e._OrtGetTensorData=O.Z)(n,s,u,m,g),e._OrtReleaseTensor=n=>(e._OrtReleaseTensor=O._)(n),e._OrtCreateRunOptions=(n,s,u,m)=>(e._OrtCreateRunOptions=O.$)(n,s,u,m),e._OrtAddRunConfigEntry=(n,s,u)=>(e._OrtAddRunConfigEntry=O.aa)(n,s,u),e._OrtReleaseRunOptions=n=>(e._OrtReleaseRunOptions=O.ba)(n),e._OrtCreateBinding=n=>(e._OrtCreateBinding=O.ca)(n),e._OrtBindInput=(n,s,u)=>(e._OrtBindInput=O.da)(n,s,u),e._OrtBindOutput=(n,s,u,m)=>(e._OrtBindOutput=O.ea)(n,s,u,m),e._OrtClearBoundOutputs=n=>(e._OrtClearBoundOutputs=O.fa)(n),e._OrtReleaseBinding=n=>(e._OrtReleaseBinding=O.ga)(n),e._OrtRunWithBinding=(n,s,u,m,g)=>(e._OrtRunWithBinding=O.ha)(n,s,u,m,g),e._OrtRun=(n,s,u,m,g,T,P,z)=>(e._OrtRun=O.ia)(n,s,u,m,g,T,P,z),e._OrtEndProfiling=n=>(e._OrtEndProfiling=O.ja)(n);var vt=e._malloc=n=>(vt=e._malloc=O.ka)(n);e._free=n=>(e._free=O.la)(n);var Tt=n=>(Tt=O.na)(n),Ot=()=>(Ot=O.oa)(),At=n=>(At=O.pa)(n),St=n=>(St=O.qa)(n);function Jr(n){n=Object.assign({},n);var s=m=>()=>m()>>>0,u=m=>g=>m(g)>>>0;return n.__errno_location=s(n.__errno_location),n.malloc=u(n.malloc),n.stackSave=s(n.stackSave),n.stackAlloc=u(n.stackAlloc),n}e.stackAlloc=St,e.stackSave=Ot,e.stackRestore=At,e.UTF8ToString=he,e.stringToUTF8=(n,s,u)=>Ve(n,K,s,u),e.lengthBytesUTF8=Ae;var Re;re=function n(){Re||xt(),Re||(re=n)};function xt(){function n(){if(!Re&&(Re=!0,e.calledRun=!0,!Ee)){if(ee(_e),a(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;){var s=e.postRun.shift();ve.unshift(s)}ee(ve)}}if(!(0<I)){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)ie();ee(Ce),0<I||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),n()},1)):n())}}if(e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return xt(),t.ready}})();typeof pr=="object"&&typeof nt=="object"?nt.exports=dr:typeof define=="function"&&define.amd&&define([],()=>dr)});var at,un,ot,st,He,hr,fn,cn,ln,yr,M,ge=B(()=>{"use strict";at=mr();un=at,st=!1,He=!1,hr=!1,fn=r=>{if(r===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+r+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+r+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},cn=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},ln=(r,t)=>r?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",yr=async r=>{if(st)return Promise.resolve();if(He)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(hr)throw new Error("previous call to 'initializeWebAssembly()' failed.");He=!0;let t=r.initTimeout,e=r.numThreads,a=r.simd,o=fn(e),d=a&&cn(),i=r.wasmPaths,c=typeof i=="string"?i:void 0,f=ln(d,o),l=typeof i=="object"?i[f]:void 0,y=!1,w=[];if(t>0&&w.push(new Promise(h=>{setTimeout(()=>{y=!0,h()},t)})),w.push(new Promise((h,b)=>{(o?un:at)({locateFile:(S,_)=>S.endsWith(".wasm")?l||(c??_)+f:_+S}).then(S=>{He=!1,st=!0,ot=S,h()},S=>{He=!1,hr=!0,b(S)})})),await Promise.race(w),y)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},M=()=>{if(st&&ot)return ot;throw new Error("WebAssembly is not initialized yet.")}});var L,Ie,F,$e=B(()=>{"use strict";ge();L=(r,t)=>{let e=M(),a=e.lengthBytesUTF8(r)+1,o=e._malloc(a);return e.stringToUTF8(r,o,a),t.push(o),o},Ie=(r,t,e,a)=>{if(typeof r=="object"&&r!==null){if(e.has(r))throw new Error("Circular reference in options");e.add(r)}Object.entries(r).forEach(([o,d])=>{let i=t?t+o:o;if(typeof d=="object")Ie(d,i+".",e,a);else if(typeof d=="string"||typeof d=="number")a(i,d.toString());else if(typeof d=="boolean")a(i,d?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof d}`)})},F=r=>{let t=M(),e=t.stackSave();try{let a=t.stackAlloc(8);t._OrtGetLastError(a,a+4);let o=t.HEAP32[a/4],d=t.HEAPU32[a/4+1],i=d?t.UTF8ToString(d):"";throw new Error(`${r} ERROR_CODE: ${o}, ERROR_MESSAGE: ${i}`)}finally{t.stackRestore(e)}}});var wr,gr=B(()=>{"use strict";ge();$e();wr=r=>{let t=M(),e=0,a=[],o=r||{};try{if(r?.logSeverityLevel===void 0)o.logSeverityLevel=2;else if(typeof r.logSeverityLevel!="number"||!Number.isInteger(r.logSeverityLevel)||r.logSeverityLevel<0||r.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${r.logSeverityLevel}`);if(r?.logVerbosityLevel===void 0)o.logVerbosityLevel=0;else if(typeof r.logVerbosityLevel!="number"||!Number.isInteger(r.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${r.logVerbosityLevel}`);r?.terminate===void 0&&(o.terminate=!1);let d=0;return r?.tag!==void 0&&(d=L(r.tag,a)),e=t._OrtCreateRunOptions(o.logSeverityLevel,o.logVerbosityLevel,!!o.terminate,d),e===0&&F("Can't create run options."),r?.extra!==void 0&&Ie(r.extra,"",new WeakSet,(i,c)=>{let f=L(i,a),l=L(c,a);t._OrtAddRunConfigEntry(e,f,l)!==0&&F(`Can't set a run config entry: ${i} - ${c}.`)}),[e,a]}catch(d){throw e!==0&&t._OrtReleaseRunOptions(e),a.forEach(i=>t._free(i)),d}}});var dn,pn,mn,hn,br,Er=B(()=>{"use strict";ge();$e();dn=r=>{switch(r){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${r}`)}},pn=r=>{switch(r){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${r}`)}},mn=r=>{r.extra||(r.extra={}),r.extra.session||(r.extra.session={});let t=r.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),r.executionProviders&&r.executionProviders.some(e=>(typeof e=="string"?e:e.name)==="webgpu")&&(r.enableMemPattern=!1)},hn=(r,t,e)=>{for(let a of t){let o=typeof a=="string"?a:a.name;switch(o){case"webnn":if(o="WEBNN",typeof a!="string"){let i=a;if(i?.deviceType){let c=L("deviceType",e),f=L(i.deviceType,e);M()._OrtAddSessionConfigEntry(r,c,f)!==0&&F(`Can't set a session config entry: 'deviceType' - ${i.deviceType}.`)}if(i?.numThreads){let c=i.numThreads;(typeof c!="number"||!Number.isInteger(c)||c<0)&&(c=0);let f=L("numThreads",e),l=L(c.toString(),e);M()._OrtAddSessionConfigEntry(r,f,l)!==0&&F(`Can't set a session config entry: 'numThreads' - ${i.numThreads}.`)}if(i?.powerPreference){let c=L("powerPreference",e),f=L(i.powerPreference,e);M()._OrtAddSessionConfigEntry(r,c,f)!==0&&F(`Can't set a session config entry: 'powerPreference' - ${i.powerPreference}.`)}}break;case"webgpu":if(o="JS",typeof a!="string"){let i=a;if(i?.preferredLayout){if(i.preferredLayout!=="NCHW"&&i.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${i.preferredLayout}`);let c=L("preferredLayout",e),f=L(i.preferredLayout,e);M()._OrtAddSessionConfigEntry(r,c,f)!==0&&F(`Can't set a session config entry: 'preferredLayout' - ${i.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${o}`)}let d=L(o,e);M()._OrtAppendExecutionProvider(r,d)!==0&&F(`Can't append execution provider: ${o}.`)}},br=r=>{let t=M(),e=0,a=[],o=r||{};mn(o);try{let d=dn(o.graphOptimizationLevel??"all"),i=pn(o.executionMode??"sequential"),c=typeof o.logId=="string"?L(o.logId,a):0,f=o.logSeverityLevel??2;if(!Number.isInteger(f)||f<0||f>4)throw new Error(`log serverity level is not valid: ${f}`);let l=o.logVerbosityLevel??0;if(!Number.isInteger(l)||l<0||l>4)throw new Error(`log verbosity level is not valid: ${l}`);let y=typeof o.optimizedModelFilePath=="string"?L(o.optimizedModelFilePath,a):0;if(e=t._OrtCreateSessionOptions(d,!!o.enableCpuMemArena,!!o.enableMemPattern,i,!!o.enableProfiling,0,c,f,l,y),e===0&&F("Can't create session options."),o.executionProviders&&hn(e,o.executionProviders,a),o.enableGraphCapture!==void 0){if(typeof o.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${o.enableGraphCapture}`);let w=L("enableGraphCapture",a),h=L(o.enableGraphCapture.toString(),a);t._OrtAddSessionConfigEntry(e,w,h)!==0&&F(`Can't set a session config entry: 'enableGraphCapture' - ${o.enableGraphCapture}.`)}if(o.freeDimensionOverrides)for(let[w,h]of Object.entries(o.freeDimensionOverrides)){if(typeof w!="string")throw new Error(`free dimension override name must be a string: ${w}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let b=L(w,a);t._OrtAddFreeDimensionOverride(e,b,h)!==0&&F(`Can't set a free dimension override: ${w} - ${h}.`)}return o.extra!==void 0&&Ie(o.extra,"",new WeakSet,(w,h)=>{let b=L(w,a),E=L(h,a);t._OrtAddSessionConfigEntry(e,b,E)!==0&&F(`Can't set a session config entry: ${w} - ${h}.`)}),[e,a]}catch(d){throw e!==0&&t._OrtReleaseSessionOptions(e),a.forEach(i=>t._free(i)),d}}});var it,vr,ut,Tr,Or,ze,Ar,ft=B(()=>{"use strict";it=r=>{switch(r){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${r}`)}},vr=r=>{switch(r){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${r}`)}},ut=r=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][r],Tr=r=>{switch(r){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${r}`)}},Or=r=>{switch(r){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${r}`)}},ze=r=>r==="float32"||r==="float16"||r==="int32"||r==="int64"||r==="uint32"||r==="uint8"||r==="bool",Ar=r=>{switch(r){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${r}`)}}});var Pe,ct=B(()=>{"use strict";Pe=async r=>{if(typeof r=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(r))}catch(t){if(t.code==="ERR_FS_FILE_TOO_LARGE"){let e=(void 0)(r),a=[];for await(let o of e)a.push(o);return new Uint8Array(Buffer.concat(a))}throw t}else{let t=await fetch(r);if(!t.ok)throw new Error(`failed to load external data file: ${r}`);let e=t.headers.get("Content-Length"),a=e?parseInt(e,10):0;if(a<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${r}, no response body.`);let o=t.body.getReader(),d;try{d=new ArrayBuffer(a)}catch(c){if(c instanceof RangeError){let f=Math.ceil(a/65536);d=new WebAssembly.Memory({initial:f,maximum:f}).buffer}else throw c}let i=0;for(;;){let{done:c,value:f}=await o.read();if(c)break;let l=f.byteLength;new Uint8Array(d,i,l).set(f),i+=l}return new Uint8Array(d,0,a)}}else return r instanceof Blob?new Uint8Array(await r.arrayBuffer()):r instanceof Uint8Array?r:new Uint8Array(r)}});var yn,xr,Ir,be,wn,lt,Pr,Br,Sr,Cr,_r,Dr=B(()=>{"use strict";gr();Er();ft();ge();$e();ct();yn=(r,t)=>{M()._OrtInit(r,t)!==0&&F("Can't initialize onnxruntime.")},xr=async r=>{yn(r.wasm.numThreads,Or(r.logLevel))},Ir=async(r,t)=>{},be=new Map,wn=r=>{let t=M(),e=t.stackSave();try{let a=t.stackAlloc(8);return t._OrtGetInputOutputCount(r,a,a+4)!==0&&F("Can't get session input/output count."),[t.HEAP32[a/4],t.HEAP32[a/4+1]]}finally{t.stackRestore(e)}},lt=r=>{let t=M(),e=t._malloc(r.byteLength);if(e===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${r.byteLength}.`);return t.HEAPU8.set(r,e),[e,r.byteLength]},Pr=async(r,t)=>{let e,a,o=M();Array.isArray(r)?[e,a]=r:r.buffer===o.HEAPU8.buffer?[e,a]=[r.byteOffset,r.byteLength]:[e,a]=lt(r);let d=0,i=0,c=0,f=[],l=[],y=[];try{if([i,f]=br(t),t?.externalData&&o.mountExternalData){let x=[];for(let C of t.externalData){let N=typeof C=="string"?C:C.path;x.push(Pe(typeof C=="string"?C:C.data).then(O=>{o.mountExternalData(N,O)}))}await Promise.all(x)}d=await o._OrtCreateSession(e,a,i),d===0&&F("Can't create a session.");let[w,h]=wn(d),b=!!t?.enableGraphCapture,E=[],A=[],S=[];for(let x=0;x<w;x++){let C=o._OrtGetInputName(d,x);C===0&&F("Can't get an input name."),l.push(C),E.push(o.UTF8ToString(C))}for(let x=0;x<h;x++){let C=o._OrtGetOutputName(d,x);C===0&&F("Can't get an output name."),y.push(C);let N=o.UTF8ToString(C);A.push(N)}let _=null;return be.set(d,[d,l,y,_,b,!1]),[d,E,A]}catch(w){throw l.forEach(h=>o._OrtFree(h)),y.forEach(h=>o._OrtFree(h)),c!==0&&o._OrtReleaseBinding(c),d!==0&&o._OrtReleaseSession(d),w}finally{o._free(e),i!==0&&o._OrtReleaseSessionOptions(i),f.forEach(w=>o._free(w)),o.unmountExternalData?.()}},Br=r=>{let t=M(),e=be.get(r);if(!e)throw new Error(`cannot release session. invalid session id: ${r}`);let[a,o,d,i,c]=e;i&&(c&&t._OrtClearBoundOutputs(i.handle),t._OrtReleaseBinding(i.handle)),t.jsepOnReleaseSession?.(r),o.forEach(f=>t._OrtFree(f)),d.forEach(f=>t._OrtFree(f)),t._OrtReleaseSession(a),be.delete(r)},Sr=(r,t,e,a,o,d=!1)=>{if(!r){t.push(0);return}let i=M(),c=r[0],f=r[1],l=r[3],y,w;if(c==="string"&&l==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(d&&l!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${o} when enableGraphCapture is true.`);if(l==="gpu-buffer"){let E=r[2].gpuBuffer,A=ut(it(c));w=f.reduce((_,x)=>_*x,1)*A;let S=i.jsepRegisterBuffer;if(!S)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');y=S(a,o,E,w)}else{let E=r[2];if(Array.isArray(E)){w=4*E.length,y=i._malloc(w),e.push(y);let A=y/4;for(let S=0;S<E.length;S++){if(typeof E[S]!="string")throw new TypeError(`tensor data at index ${S} is not a string`);i.HEAPU32[A++]=L(E[S],e)}}else w=E.byteLength,y=i._malloc(w),e.push(y),i.HEAPU8.set(new Uint8Array(E.buffer,E.byteOffset,w),y)}let h=i.stackSave(),b=i.stackAlloc(4*f.length);try{let E=b/4;f.forEach(S=>i.HEAP32[E++]=S);let A=i._OrtCreateTensor(it(c),y,w,b,f.length,Ar(l));A===0&&F(`Can't create tensor for input/output. session=${a}, index=${o}.`),t.push(A)}finally{i.stackRestore(h)}},Cr=async(r,t,e,a,o,d)=>{let i=M(),c=be.get(r);if(!c)throw new Error(`cannot run inference. invalid session id: ${r}`);let f=c[0],l=c[1],y=c[2],w=c[3],h=c[4],b=c[5],E=t.length,A=a.length,S=0,_=[],x=[],C=[],N=[],O=i.stackSave(),Ee=i.stackAlloc(E*4),ae=i.stackAlloc(E*4),K=i.stackAlloc(A*4),v=i.stackAlloc(A*4);try{[S,_]=wr(d);for(let I=0;I<E;I++)Sr(e[I],x,N,r,t[I],h);for(let I=0;I<A;I++)Sr(o[I],C,N,r,E+a[I],h);let R=Ee/4,Be=ae/4,Ce=K/4,_e=v/4;for(let I=0;I<E;I++)i.HEAPU32[R++]=x[I],i.HEAPU32[Be++]=l[t[I]];for(let I=0;I<A;I++)i.HEAPU32[Ce++]=C[I],i.HEAPU32[_e++]=y[a[I]];i.jsepOnRunStart?.(f);let ve;ve=await i._OrtRun(f,ae,Ee,E,v,A,K,S),ve!==0&&F("failed to call OrtRun().");let ie=[];for(let I=0;I<A;I++){let Q=i.HEAPU32[K/4+I];if(Q===C[I]){ie.push(o[I]);continue}let re=i.stackSave(),Z=i.stackAlloc(4*4),ue=!1,W,X=0;try{i._OrtGetTensorData(Q,Z,Z+4,Z+8,Z+12)!==0&&F(`Can't access output tensor data on index ${I}.`);let me=Z/4,Te=i.HEAPU32[me++];X=i.HEAPU32[me++];let De=i.HEAPU32[me++],ne=i.HEAPU32[me++],ee=[];for(let $=0;$<ne;$++)ee.push(i.HEAPU32[De/4+$]);i._OrtFree(De);let fe=ee.reduce(($,H)=>$*H,1);W=vr(Te);let Oe=w?.outputPreferredLocations[a[I]];if(W==="string"){if(Oe==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let $=[],H=X/4;for(let te=0;te<fe;te++){let he=i.HEAPU32[H++],Ae=te===fe-1?void 0:i.HEAPU32[H]-he;$.push(i.UTF8ToString(he,Ae))}ie.push([W,ee,$,"cpu"])}else if(Oe==="gpu-buffer"&&fe>0){let $=i.jsepGetBuffer;if(!$)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let H=$(X),te=ut(Te);if(te===void 0||!ze(W))throw new Error(`Unsupported data type: ${W}`);ue=!0,ie.push([W,ee,{gpuBuffer:H,download:i.jsepCreateDownloader(H,fe*te,W),dispose:()=>{i._OrtReleaseTensor(Q)}},"gpu-buffer"])}else{let $=Tr(W),H=new $(fe);new Uint8Array(H.buffer,H.byteOffset,H.byteLength).set(i.HEAPU8.subarray(X,X+H.byteLength)),ie.push([W,ee,H,"cpu"])}}finally{i.stackRestore(re),W==="string"&&X&&i._free(X),ue||i._OrtReleaseTensor(Q)}}return w&&!h&&(i._OrtClearBoundOutputs(w.handle),be.set(r,[f,l,y,w,h,!1])),ie}finally{i.stackRestore(O),x.forEach(R=>i._OrtReleaseTensor(R)),C.forEach(R=>i._OrtReleaseTensor(R)),N.forEach(R=>i._free(R)),S!==0&&i._OrtReleaseRunOptions(S),_.forEach(R=>i._free(R))}},_r=r=>{let t=M(),e=be.get(r);if(!e)throw new Error("invalid session id");let a=e[0],o=t._OrtEndProfiling(a);o===0&&F("Can't get an profile file name."),t._OrtFree(o)}});var dt,Rr,Ur,No,Lr,Fr,kr,Mr,Nr,Wr,Gr,pt=B(()=>{"use strict";pe();Dr();ge();dt=!1,Rr=!1,Ur=!1,No=typeof document<"u"?document?.currentScript?.src:void 0,Lr=async()=>{if(!Rr){if(dt)throw new Error("multiple calls to 'initWasm()' detected.");if(Ur)throw new Error("previous call to 'initWasm()' failed.");dt=!0;try{await yr(U.wasm),await xr(U),Rr=!0}catch(r){throw Ur=!0,r}finally{dt=!1}}},Fr=async r=>{await Ir(U,r)},kr=async r=>lt(r),Mr=async(r,t)=>Pr(r,t),Nr=async r=>{Br(r)},Wr=async(r,t,e,a,o,d)=>Cr(r,t,e,a,o,d),Gr=async r=>{_r(r)}});var Hr,bn,je,$r=B(()=>{"use strict";pe();pt();ft();ct();Hr=(r,t)=>{switch(r.location){case"cpu":return[r.type,r.dims,r.data,"cpu"];case"gpu-buffer":return[r.type,r.dims,{gpuBuffer:r.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${r.location} for ${t()}`)}},bn=r=>{switch(r[3]){case"cpu":return new G(r[0],r[2],r[1]);case"gpu-buffer":{let t=r[0];if(!ze(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:e,download:a,dispose:o}=r[2];return G.fromGpuBuffer(e,{dataType:t,dims:r[1],download:a,dispose:o})}default:throw new Error(`invalid data location: ${r[3]}`)}},je=class{async fetchModelAndCopyToWasmMemory(t){return kr(await Pe(t))}async loadModel(t,e){oe();let a;typeof t=="string"?typeof process<"u"&&process.versions&&process.versions.node?a=await Pe(t):a=await this.fetchModelAndCopyToWasmMemory(t):a=t,[this.sessionId,this.inputNames,this.outputNames]=await Mr(a,e),se()}async dispose(){return Nr(this.sessionId)}async run(t,e,a){oe();let o=[],d=[];Object.entries(t).forEach(h=>{let b=h[0],E=h[1],A=this.inputNames.indexOf(b);if(A===-1)throw new Error(`invalid input '${b}'`);o.push(E),d.push(A)});let i=[],c=[];Object.entries(e).forEach(h=>{let b=h[0],E=h[1],A=this.outputNames.indexOf(b);if(A===-1)throw new Error(`invalid output '${b}'`);i.push(E),c.push(A)});let f=o.map((h,b)=>Hr(h,()=>`input "${this.inputNames[d[b]]}"`)),l=i.map((h,b)=>h?Hr(h,()=>`output "${this.outputNames[c[b]]}"`):null),y=await Wr(this.sessionId,d,f,c,l,a),w={};for(let h=0;h<y.length;h++)w[this.outputNames[c[h]]]=i[h]??bn(y[h]);return se(),w}startProfiling(){}endProfiling(){Gr(this.sessionId)}}});var En,Ye,zr=B(()=>{"use strict";pe();pt();$r();En=()=>{if((typeof U.wasm.initTimeout!="number"||U.wasm.initTimeout<0)&&(U.wasm.initTimeout=0),typeof U.wasm.simd!="boolean"&&(U.wasm.simd=!0),typeof U.wasm.proxy!="boolean"&&(U.wasm.proxy=!1),typeof U.wasm.trace!="boolean"&&(U.wasm.trace=!1),typeof U.wasm.numThreads!="number"||!Number.isInteger(U.wasm.numThreads)||U.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(U.wasm.numThreads=1);let r=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;U.wasm.numThreads=Math.min(4,Math.ceil((r||1)/2))}},Ye=class{async init(t){En(),await Lr(),await Fr(t)}async createInferenceSessionHandler(t,e){let a=new je;return await a.loadModel(t,e),Promise.resolve(a)}}});var jr={};Se(jr,{wasmBackend:()=>vn});var vn,Yr=B(()=>{"use strict";zr();vn=new Ye});var On={};Se(On,{InferenceSession:()=>Kt,TRACE:()=>et,TRACE_FUNC_BEGIN:()=>oe,TRACE_FUNC_END:()=>se,Tensor:()=>G,TrainingSession:()=>or,default:()=>Tn,env:()=>U,registerBackend:()=>we});module.exports=Ue(On);pe();pe();pe();var ar="1.18.0";var Tn=rt;{let r=(Yr(),Ue(jr)).wasmBackend;we("cpu",r,10),we("wasm",r,10)}Object.defineProperty(U.versions,"web",{value:ar,enumerable:!0});
//# sourceMappingURL=ort.wasm-core.min.js.map
